<html>

<head>
<title>New Page 1</title>
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<base target="_top">
</head>

<body link="#0000FF" vlink="#0000FF" alink="#0000FF">
<!--webbot bot="HTMLMarkup" startspan TAG="XBOT" --><IFRAME SRC="../header.html" NAME="head"  WIDTH="100%" HEIGHT="175" MARGINWIDTH="0" MARGINHEIGHT="0" FRAMEBORDER="0" noresize SCROLLING=NO><!--webbot bot="HTMLMarkup" endspan
-->
<!--webbot bot="HTMLMarkup" startspan TAG="XBOT" --></IFRAME><!--webbot bot="HTMLMarkup"
endspan -->
<p align="left"><font size="3" color="#000000" face="Bookman Old Style"><b>Cracking</b></font></p>

<p align="left">1. Disclaimer:<br>
this tutorial is for informational purposes only!<br>
Much of the information in this document can be used to perform illegal activities!<br>
Don't attempt to do anything stated in this document!<br>
If you do attempt to do anything, you are solely and fully responsible for what you do!<br>
If you get caught and get in any kind of trouble, it's your own fault!<br>
If you intend to use this information to impress your friends, leave it and grow up!<br>
If you don't agree to this, do not read any more!<br>
If you crack a program, and either sell the crack or offer it for free, it is a crime!</p>

<p align="left">2. What is Cracking?<br>
<br>
<br>
For me, cracking is:<br>
&quot;Letting a program, which is on your computer behave as you want it<br>
to behave and not behave as someone else (the programmer) wants&quot;<br>
<br>
As INTERN said:<br>
&quot;Hey, it is your stuff right? your numbers, your bits,<br>
you should be able to do anything you wish to do with it :)&quot;<br>
<br>
Actually, I agree to this.<br>
<br>
So cracking is modifying your programs, and making them work they way you want them to.<br>
U can get a free demo program, crack it, and use it.<br>
BUT!!!!<br>
I repeat, if you crack a program, and start selling the cracked version or even offering
it for free, it is a crime!<br>
___________________________________________________________________<br>
<br>
After reading those three tutorials (this is the first one in thsi series),<br>
you will feel the power you have in your hands (I mean, in your head).<br>
<br>
well, let's get started?<br>
<br>
<br>
3. Tools<br>
<br>
There are very few tools you need by now...<br>
It is very easy to find them over the web, cause they are quite popular:<br>
<br>
The first one is &quot;Win32 Disassembler&quot;, which is also know ans W32Dasm.<br>
<br>
The Win32 Disassembler allows you to:<br>
1. Disassemble files - translate the program to it's assembly origin, or machine code.<br>
The file types which can be disassambled in Win32 Disassembler:<br>
exe, 386, com, cpl, drv, dll, fon, mpd, ocx, vbx, vbx and sys.<br>
2. Load the program proccess and trace the program.<br>
3. Browse the disassembled file and go to any code location that you want.<br>
4. Find text.<br>
5. Execute, insert or remove jumps and calls.<br>
6. Import and export functions.<br>
7. Show a HEX display of a code area.<br>
8. Show the list of the STRINGS, DIALOGS and REFERENCES.<br>
9. Save the Disassembly source in text format.<br>
<br>
Well, u can get it in almost any cracking site, but I'll give you some URLs:<br>
<br>
1. http://www.wco.com/~micuan/Zips/wdasm893.zip<br>
--------------------------------------------<br>
2. HTTP://CRACKING.HOME.ML.ORG/<br>
----------------------------<br>
3. http://www.fortunecity.com/bally/waterford/18/w32dsm89.zip<br>
----------------------------------------------------------<br>
4. http://wowsites.com/meiner/w32dsm89.zip<br>
---------------------------------------<br>
<br>
I think that's about enough.<br>
If any of these links goes down, please alert me (my Email address is
sagid@netvision.net.il).<br>
<br>
The second tool you need is Hiew, which is also known as Hacker's View.<br>
The Hacker's View Tool allowes you to:<br>
1. Disassemble files.<br>
2. Make changes in the disassembled file, such as:<br>
write commands, modify commands and reassemble the file.<br>
3. View the file in ASCII, Hex or assembly mode.<br>
<br>
Here are some URL's as well:<br>
<br>
1. ftp://ftp.cs.tu-berlin.de/pub/msdos/mirrors/ftp.elf.stuba.sk/pc/utilprog/hiew584.zip<br>
------------------------------------------------------------------------------------<br>
2. ftp://ftp.bke.hu/pub/mirrors/sac/utilprog/hiew584.zip<br>
-----------------------------------------------------<br>
3. ftp://ftp.uakom.sk/pub/mirrors/sac/utilprog/hiew584.zip<br>
-------------------------------------------------------<br>
<br>
You can also download an excellent program for cracking called Soft-ICe.<br>
Anyway, we won't need it in this part of the tutorial.<br>
Anyway, here are some URLs for Soft-ICe.<br>
<br>
SoftICE for Windows95:<br>
<br>
1. http://swlink.net/~lachcik/insaine/si95w320.zip<br>
-----------------------------------------------<br>
2. http://www.fortunecity.com/bally/waterford/18/siw95-32.zip<br>
----------------------------------------------------------<br>
3. http://www.pmk.ac.th/~arnontc/files/siw95-32.zip<br>
------------------------------------------------<br>
4. ftp://toolz.ucl.autograd.ru/Debugger/W95ICE32.ZIP<br>
-------------------------------------------------<br>
<br>
SoftICE for Windown NT:<br>
<br>
1. http://www.pmk.ac.th/~arnontc/files/siwnt-32.zip<br>
------------------------------------------------<br>
2. ftp://ftp.sol.no/users/r/reopsahl/OrcPaks/orcpak9e.zip<br>
------------------------------------------------------<br>
3. http://www.fortunecity.com/bally/waterford/18/siwnt-32.zip<br>
----------------------------------------------------------<br>
4. ftp://toolz.ucl.autograd.ru/Debugger/WNTICE32.ZIP<br>
-------------------------------------------------<br>
<br>
There's also SoftICE for DOS, which I dont recommend.<br>
<br>
1. http://www.pmk.ac.th/~arnontc/files/s-ice280.zip<br>
------------------------------------------------<br>
2. ftp://ftp.ula.ve/pub/msdos/cracking/s-ice280.zip<br>
------------------------------------------------<br>
3. http://202.102.15.149/~person/paulgao/cracks/SICE280.ZIP<br>
--------------------------------------------------------<br>
4. ftp://ftp.sonic.net/pub/users/fryman/tools/S-ice280.zip<br>
-------------------------------------------------------<br>
5. http://www.chibacity.com/chiba/files/unpro/prx-pcs3.zip<br>
-------------------------------------------------------<br>
<br>
You can also download the Win 3.1x versions at:<br>
<br>
1. ftp://ftp.ula.ve/pub/msdos/cracking/m_wice13.zip<br>
------------------------------------------------<br>
2. http://fishheads.simplenet.com/BriansFiles/m_wice13.zip<br>
-------------------------------------------------------<br>
3. http://www.magiccarpet.com/~odin/files/other/m_wice13.zip<br>
---------------------------------------------------------<br>
<br>
4. The Main steps of cracking<br>
<br>
<br>
There are 7 steps in the process of cracking:<br>
<br>
1. Run the program you want to crack and learn it's standard behavior.<br>
Try to locate strings and keywords, try to enter the password and see how the program
responds.<br>
2. Open up the program with the W32Dasm and disassamble it.<br>
3. Find typical and common strings in the disassembly that appeared in the program.<br>
In most cases, you have to look for keywords such as: password, name, date, expired,<br>
time limit, wrong, entered and so on.<br>
4. Find and observe the password generator, find the learn protection routine and the API
calls.<br>
5. Try to understand the jumping mechanism of the protection.<br>
6. Open up the program in HIEW.<br>
Change the jump of the flow control to it's oposite jump command, or nop it out.<br>
7. Run and see how the change you have made in the original program affected it.<br>
Feel the power you have, the power of cracking, letting programs behave as you want them
to.<br>
<br>
Learn those steps very well, until u dream of them, u will use them in every program you
crack.<br>
<br>
5. Basic terms in Assembly<br>
<br>
-------------<br>
A. Registers:<br>
-------------<br>
Registers are variables which are stored in your processor.<br>
The processor uses these variables for basic mathimatical and logical operations.<br>
The mostly used registers are: eax, ebx, ecx and edx.<br>
Sometimes you will see edi, esi, esp, ebp.<br>
<br>
There are three types of registers: 32Bit registers, 16Bit registers and 8Bit registers.<br>
The 32Bit registers start with e, such as eax.<br>
There are 16Bit equivalents of these registers.<br>
The only Difference between the two types is the veriable size.<br>
These registers are: ax, bx, cx, dx, di, si, sp, bp.<br>
<br>
There are also 8 bit registers.<br>
Tthe 8Bit registers are: al, ah, bl, bh, cl, ch, dl, dh.<br>
l - means the lower 8 bits of the 16Bit register.<br>
h - means the higher 8 bits of the 16Bit register.<br>
Here the l stands for the lower and h for the higher 8 bits of a 16 bit register.<br>
<br>
--------<br>
B. Flags<br>
--------<br>
Flags are Boolean variables (get 0 or 1 values).<br>
Flags are used by the processor for internal logical and mathimatical operations,<br>
in order to get the result of the operation.<br>
The most important flag is the Zero Flag, which can get zero or non-zero (1) values.<br>
<br>
------------<br>
C. Code Flow<br>
------------<br>
When you are analyzing a piece of code, you must understand that the processor<br>
is actually quite stupid, and all it does is to simply follow the basic instructions,<br>
line by line.<br>
It does anything the code tells it to do, and cannot do anything that is not written<br>
in the code (unless it has been run over by a herd of cows and abducted by aliens).<br>
This is why you have to think like the processor when you're analyzing a piece of code,<br>
and to act like it (just don't get used to it! Inhale, exhale, inhale, exhale...
nevermind, stupid joke) :)<br>
You have to do everything the processor does, you have to compare registers and variables,
execute jumps and calls,<br>
calculate Basic mathimatical operations, store and load register values and adresses, and
so on...<br>
<br>
The processor has an instruction pointer especially for this, which is also called IP<br>
(it has nothing to do with IP addresses in the Internet Protocol, trust me).<br>
Using the instruction pointer, the processor points to the instruction that is about to be
executed.<br>
The processor also has and executes instructions which change the code flow.<br>
These instructions can be function calls, any other routine calls, jumps, conditional
jumps, which depend<br>
on the zero flag, negative conditional jumps...</p>

<p align="left">By now, in this part of the tutorial, you have learnt the main steps of
cracking.<br>
Now, you are going to crack your first program.<br>
<br>
But before that, you need to get a little program called: &quot;Sweet Little Piano&quot;<br>
You can download it from:<br>
-----------------<br>
www.ronimusic.com<br>
-----------------<br>
<br>
Now, when you have the program, let's start!<br>
<br>
<br>
4. Cracking the first program (Sweet little Piano)<br>
<br>
<br>
Now we will follow each step and crack the program:<br>
<br>
____________________________<br>
Step 1: Running the program:<br>
____________________________<br>
<br>
Well, Run it! Duh... :-)<br>
<br>
Well, what do we see here.....<br>
The program opens two text files.<br>
Also we see &quot;Unregistered Shareware&quot; on the caption bar...<br>
Now let's open the Help menu for any registration options...<br>
Humm, what do we see here now...<br>
oh, it's a password option... <br>
Well, select it and enter something (don't hope it will be right :-)).<br>
To see what happens... Click OK..<br>
Hmm, nothing happens....<br>
Maybe it accepted it? Hmm.. no way... the caption bar still says Unregistered...<br>
Ok close it... bah ... more text files ... and a notification that the settings are not<br>
saved in the unregistered version ... well ... kind of irritating those text files!<br>
Let's fix it :-)<br>
<br>
________________________________<br>
Step 2: Disassemble the program:<br>
________________________________<br>
<br>
Disassemble the program. Good, small is fast :-) Always....<br>
Now, we don't have any strings that pop up when we want to register something...<br>
Let's browse for strings like registered, unregistered, the string about the unsaved
settings.<br>
Hmm... evaluation time left ... password.txt.... passworddialog.... <br>
sweet little piano - Unregistered &lt;&lt;-- looks like our caption bar ;-) go on...<br>
Thanks for registering ... cool! So it thanks you anyway :-)<br>
Let's jump to that place ... Double click on it an we will pop right on top of the
registration routine...<br>
<br>
_____________________________________________________________________<br>
Step 3: Analyzing the protection routine.... / Understanding the jumping Mechanism...<br>
______________________________________________________________________<br>
Let's analyze the protection routine.<br>
<br>
////////////////////// Code snip ///////////////////////////<br>
ADDRESS MACHINE CODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ASSEMBLER INSTRUCTIONS<br>
<br>
* Possible Reference to Dialog: PASSWORDDIALOG, CONTROL_ID:0064, &quot;&quot;<br>
|<br>
:00401715 6A64 push 00000064<br>
:00401717 53 push ebx<br>
<br>
* Reference To: USER32.GetDlgItemTextA, Ord:0000h<br>
|<br>
:00401718 E8A5B50000 Call 0040CCC2<br>
:0040171D E822FFFFFF call 00401644<br>
:00401722 85C0 test eax, eax<br>
:00401724 741E je 00401744<br>
:00401726 6A30 push 00000030<br>
<br>
* Possible StringData Ref from Data Obj -&gt;&quot;SweetPiano&quot;<br>
|<br>
:00401728 6866D24000 push 0040D266<br>
<br>
* Possible StringData Ref from Data Obj -&gt;&quot;Thanks for registering!&quot;<br>
|<br>
:0040172D 68FED14000 push 0040D1FE<br>
:00401732 53 push ebx<br>
<br>
////////////////////// Code snip ///////////////////////////<br>
<br>
PasswordDialog ... a call to GetDlgItemTextA ... another call.... a test...<br>
and depending on the test a je.... The je jumps over the thank you ... <br>
And just ends the dialog box ... without telling you that you entered something wrong...<br>
So this is right ... we did indeed not see that we typed something wrong ... but
apparently we are supposed to see <br>
if we type something right :-)<br>
<br>
Again execute the je jump, and look where it goes to ... return from the jump....<br>
Now lets try to rewrite what goes on here...<br>
<br>
_____________________________________________________________<br>
call ShowPasswordDialog<br>
call GetEnteredText<br>
call IsEnteredTextGood<br>
test value in eax<br>
je QuietExit<br>
<br>
ShowThanksForRegistering<br>
<br>
QuietExit:<br>
______________________________________________________________<br>
<br>
the source code must have looked like this :<br>
___________________________________________________________________________<br>
GetDlgItemText(_ID_Serial);<br>
if (EnteredTextGood) ShowThanksForRegistering<br>
<br>
// else nothing....<br>
___________________________________________________________________________<br>
<br>
This is another interesting piece of code.... test eax, eax ... this assembler instruction
tests</p>

<p align="left">if the value of eax is equal to itself ... if it is it is equal ... so a
je instruction jumps ... if it is not equal, it does not jump.... <br>
To crack this program we can change the je instruction into two nop instructions... and we
are done...<br>
<br>
<br>
<br>
We have seen here, that the call has put a value in eax.... something which is not equal
to zero or a zero... In our <br>
previous example we saw that the called Is_Serial_Valid call set some value in memory ...
Here we see that the called <br>
Is_Serial_Valid call sets the eax register of our processor to some value....<br>
<br>
Step 4: Changing the original program...<br>
So modify it :-)<br>
1. Open Hiew.<br>
2. Open the file within Hiew.<br>
3. Find the Adress of the line in W32Dasm (it's on the status bar beginning with '@').<br>
4. Press F5 in Hiew.<br>
5. Enter the address you have found in (4) and press ENTER.<br>
6. Press F3 - for activating the write option.<br>
7. Press F2 - to change the instruction.<br>
8. Replace the command by 'NOP' (without quotes), which means NO OPERATION.<br>
9. Now a new command appeared in the next line.<br>
10. Replace it by NOP too.<br>
11. If another new instruction hasn't appeared, Press F9 to update the file.<br>
12. Press F10 to exit.<br>
13. Run the program and see the result.<br>
</p>
</body>
</html>
<!--webbot bot="HTMLMarkup" startspan TAG="XBOT" --><IFRAME SRC="../footer.html" NAME="bol" WIDTH="100%" HEIGHT="97" MARGINWIDTH="0" MARGINHEIGHT="0" FRAMEBORDER="0" noresize SCROLLING=NO><!--webbot bot="HTMLMarkup" endspan
-->
<!--webbot bot="HTMLMarkup" startspan TAG="XBOT" --></IFRAME><!--webbot bot="HTMLMarkup"
endspan -->
